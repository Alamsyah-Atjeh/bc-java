apply plugin: 'application'

dependencies {
    implementation group: 'org.openjdk.jmh', name: 'jmh-core', version: '1.33'
    annotationProcessor group: 'org.openjdk.jmh', name: 'jmh-generator-annprocess', version: '1.33'
}
application {
    mainClass.set("org.bouncycastle.crypto.fpe.SP80038GMicroBenchmark")
}

test {
    forkEvery = 1;
    maxParallelForks = 8;
}


task test11(type:Test) {
    forkEvery = 1;
    maxParallelForks = 1;

    systemProperty 'bc.test.data.home', bcTestDataHome
    maxHeapSize = "1536m"
    testLogging.showStandardStreams = true

    javaLauncher = javaToolchains.launcherFor {
        languageVersion = JavaLanguageVersion.of(11)
    }

    jvmArgs=['-Dtest.java.version.prefix=11.']


    finalizedBy jacocoTestReport

    filter {
        includeTestsMatching "AllTest*"
        if (project.hasProperty('excludeTests')) {
            excludeTestsMatching "${excludeTests}"
        }
    }
}